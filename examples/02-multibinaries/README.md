# Multibinaries
*Makemore* is able to generate several binaries from the same *Makefile* and all kinds of binaries:

 * *bin-y+=myapp* : generic application : <bindir>/myapp : :
 * *sbin-y+=mysuperapp* : application for the root user : <sbindir>/*mysuperapp* : :
 * *lib-y+=mylibrary* : dynamic library : <libdir><extension>/lib*mylibrary*.so<version> : :
 * *slib-y+=mylibrary* : static library : <libdir><extension>/lib*mylibrary*.a : :
 * *modules-y+=mymodule* : dynamic library : <pkglibdir>/*mymodule*.so : see [module](../04_module/README.md) :
 * *hostbin-y+=mytool* : generic application for the build : *N/A* : see [cross compiling](../05_crosscompiling/README.md) :
 * *hostslib-y+=mylibrary* : static library for the build : *N/A* : see [cross compiling](../05_crosscompiling/README.md) :

The used variable defines the type and the installation of the binary.

## Binary types
### Applications
The previous chapter show the use case of the generic application. Two others cases are availables.

The *sbin-y* uses exactly the same build rules than the *bin-y*. The difference is the installation directory.

```bash
$ make PREFIX=/usr install V=1
  install -D myapp /usr/bin/myapp
  install -D mysuperapp /usr/sbin/mysuperapp
```

The *hostbin-y* allows to build an application on the host system. This application will be not installed. It may be a test application or a code generator for the main applications.
It may use another C Compiler and Linker than the main applications. This feature is intersting for the *Cross-Compiling*.

The binary is build into the *host* directory.

### Libraries
*Makemore* may build dynamic and static libraries. The installation try to keep the format used by the system:

 * on a generic system : <exec\_prefix>/lib/lib*mylibrary*.so
 * on debian like : <exec\_prefix>/lib/<arch>/lib*mylibrary*.so
 * on redhat like : <exec\_prefix>/lib[32/64]/lib*mylibrary*.so

The *hostslib-y* allows to build static library for *hostbin-y* with the same rules and the same goal.

### Modules
A module is a dynamic library that an application may load at the runtime. The application may choice by coding to load or not the modules while the dynamic libraries are automaticly loaded.

The installation of the modules doesn't depends on the system. But on UNIX the path <prefix>/lib/<project> is often used, where <project> is defined by the application.

### Application and static library for hosting

## Versionning
*Makemore* allows to set a package name ans a version for all binaries built. The *package* and *version* variables may be defined inside the main *Makefile* and the binaries may use their values with some variables defined into the *version.h* file. This file is generated by *Makemore* during the build process.

```Makefile
package=foo
version=0.1

include scripts.mk

# simple binary installed to <prefix_exec>/bin directory
bin-y+=foo
foo_SOURCES+=foo.c
```

```C
#ifndef __VERSION_H__
#define __VERSION_H__

#define VERSION 0.1
#define VERSION_MAJOR 0
#define VERSION_MINOR 1
#define PACKAGE "foo"
#define PACKAGE_VERSION "0.1"
#define PACKAGE_NAME "foo"
#define PACKAGE_TARNAME "foo"
#define PACKAGE_STRING "foo 0.1"
#endif
```

The *version* is used to add a suffix to the dynamic libraries. And the *package* is used for the modules installation.
